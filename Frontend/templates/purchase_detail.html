{% extends "base.html" %}
{% block content %}
<h2>Purchase Detail - Invoice #{{ purchase.invoice_no }}</h2>
<p><strong>Date:</strong> {{ purchase.purchase_date }}</p>
<p><strong>Distributor:</strong> {{ purchase.distributor_name or 'N/A' }}</p>
<p><strong>Trade Type:</strong> {{ purchase.trade_type or 'N/A' }}</p>

<table class="table table-bordered mt-3" id="purchase-detail-table">
  <thead>
    <tr>
      <th>Sr No</th>
      <th>Item</th>
      <th>Batch</th>
      <th>Expiry</th>
      <th>HSN</th>
      <th>MRP</th>
      <th>Qty</th>
      <th>Rate</th>
      <th>Packing</th>
      <th>Free</th>
      <th>GST %</th>
      <th>Amount</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ item.name }}</td>
      <td>{{ item.batch_no or '' }}</td>
      <td>{{ item.expiry_date or '' }}</td>
      <td>{{ item.hsn_code or '' }}</td>
      <td>{{ "%.2f"|format(item.mrp or 0) }}</td>
      <td>{{ item.quantity }}</td>
      <td>{{ "%.2f"|format(item.rate or 0) }}</td>
      <td>{{ item.packing or '' }}</td>
      <td>{{ item.get('free', 0) }}</td>
      <td>{{ "%.2f"|format(item.get('gst_percent', (item.get('sgst_percent',0) or 0) + (item.get('cgst_percent',0) or 0))) }}</td>
      <td>{{ "%.2f"|format(item.amount or 0) }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<p><strong>Total Amount: Rs {{ "%.2f"|format(purchase.total_amount or 0) }}</strong></p>
<p><strong>Discount: </strong> {{ (purchase.discount_value is not none) and ("%.2f%%"|format(purchase.discount_value)) or '0.00%' }}</p>

{% endblock %}
